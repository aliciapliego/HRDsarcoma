'SS',
'DT'),
plot_bgcolor='rgb(233,233,233)')
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = grey.colors(), colors = "Set1", type = "box",  text = df_sarcoma$Case.ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = grey.colors(), colors = "Greys", type = "box",  text = df_sarcoma$Case.ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
df_sarcoma_dv = read.csv('/Users/aliciapliego/Projects/HRDsarcoma/data/HRD_results_subgroupsSarcoma.tsv', sep = '\t', header= TRUE)
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = grey.colors(), colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = grey.colors(), colors = "Set1", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = grey.colors(), colors = "RdGy", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = grey.colors(), colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH,  colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type,  type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
rlang::last_error()
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Greys", type = "box",  text = df_sarcoma$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~TAI, color = ~Type, type = "box",  text = df_sarcoma$Case.ID)
fig
df_sarcoma_dv = read.csv('/Users/aliciapliego/Projects/HRDsarcoma/data/HRD_results_subgroupsSarcoma.tsv', sep = '\t', header= TRUE)
View(df_sarcoma)
df_sarcoma_dv = read.csv('/Users/aliciapliego/Projects/HRDsarcoma/data/HRD_results_subgroupsSarcoma.tsv', sep = '\t', header= TRUE)
View(df_sarcoma_dv)
fig <- plot_ly(df_sarcoma_dv, y = ~TAI, color = ~Type, type = "box",  text = df_sarcoma$Case.ID)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Greys", type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = "Gray", type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
palette.colors("Greys")
display.brewer.pal(n = 8, name = 'Greys')
library("RColorBrewer")
display.brewer.pal(n = 8, name = 'Greys')
brewer.pal(n = 8, name = "RdBu")
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = c("#D6604D", "#F4A582", "#FDDBC7", "#D1E5F0","#92C5DE", "#4393C3" ,"#2166AC", "#FDDBC7", "#D1E5F0","#92C5DE", "#4393C3" ,"#2166AC"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
brewer.pal(n = 8, name = "Greys")
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = c("#F0F0F0", "#D9D9D9" ,"#BDBDBD" ,"#969696", "#737373" ,"#525252","#252525","#BDBDBD" ,"#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = c("#F0F0F0", "#D9D9D9" ,"#969696", "#737373" ,"#525252","#252525" ,"#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = c("#F0F0F0", "#D9D9D9" , "#737373" ,"#525252","#252525" ,"#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
brewer.pal(n = 8, name = "Greys")
display.brewer.pal(n = 8, name = 'Greys')
fig <- plot_ly(df_sarcoma_dv, y = ~LOH, color = ~Type, colors = c("#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~HRDscore, color = ~Type, colors = c("#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma_dv, y = ~HRD.sum, color = ~Type, colors = c("#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
fig <- plot_ly(df_sarcoma, y = ~LOH, color = ~Cancer_type, type = "box",  text = df_sarcoma$Case_ID)
fig
fig <- plot_ly(df_sarcoma, y = ~LOH, color = ~Cancer_type,colors = c("#969696", "#737373" ,"#525252","#252525","#969696"), type = "box",  text = df_sarcoma$Case_ID)
fig
df_sarcoma = read.table('/Users/aliciapliego/Projects/HRDsarcoma/data/HRDness_TCGA_sarcoma_all.tsv', sep = '\t', header = TRUE)
fig <- plot_ly(df_sarcoma, y = ~LOH, color = ~Cancer_type,colors = c("#969696", "#737373" ,"#525252","#252525","#969696"), type = "box",  text = df_sarcoma$Case_ID, notched=TRUE)
fig
fig <- plot_ly(df_sarcoma, y = ~TAI, color = ~Cancer_type,colors = c("#969696", "#737373" ,"#525252","#252525","#969696"), type = "box",  text = df_sarcoma$Case_ID, notched=TRUE)
fig
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
fig <- plot_ly(df_sarcoma_dv, y = ~TAI, color = ~Type, colors = c("#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525","#969696", "#737373" ,"#525252","#252525"), type = "box",  text = df_sarcoma_dv$Case_ID, notched=TRUE) %>%
layout(
xaxis = list(title = "",
categoryorder = "array",
categoryarray = c('HGSOC',
'TNBC',
'CRC',
'UPS',
'MFS',
'OS',
'uLMS',
'MPNST',
'LMS',
'ddLPS',
'SS',
'DT'))
)
fig
df_sarcoma_dv
df_sarcoma_dv
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
rmarkdown::render_site()
library(heatmaply)
heatmaply(heat,
scale_fill_gradient_fun = ggplot2::scale_fill_gradient2(
low = "blue",
high = "red",
midpoint = 0.5,
limits = c(0, 1)
),
Colv = FALSE,
Rowv =TRUE,
showticklabels = c(TRUE, FALSE),
scale = "row",
main = "Heatmap of Differentially expressed genes in all sarcomas",
row_side_colors = coldata[, c( "HRDscore34", "site_of_disease","annotation", "other_dx")]
)
library(devtools)
install_github("parklab/ShatterSeek")
library(ShatterSeek)
library(ShatterSeek)
data(DO17373)
SV_data <- SVs(chrom1=as.character(SV_DO17373$chrom1),
pos1=as.numeric(SV_DO17373$start1),
chrom2=as.character(SV_DO17373$chrom2),
pos2=as.numeric(SV_DO17373$end2),
SVtype=as.character(SV_DO17373$svclass),
strand1=as.character(SV_DO17373$strand1),
strand2=as.character(SV_DO17373$strand2))
CN_data <- CNVsegs(chrom=as.character(SCNA_DO17373$chromosome),
start=SCNA_DO17373$start,
end=SCNA_DO17373$end,
total_cn=SCNA_DO17373$total_cn)
chromothripsis <- shatterseek(
SV.sample=SV_data,
seg.sample=CN_data,
genome="hg19")
library(gridExtra)
library(cowplot)
plots_chr21 <- plot_chromothripsis(ShatterSeek_output = chromothripsis,
chr = "chr21", sample_name="DO17373", genome="hg19")
plot_chr21 = arrangeGrob(plots_chr21[[1]],
plots_chr21[[2]],
plots_chr21[[3]],
plots_chr21[[4]],
nrow=4,ncol=1,heights=c(0.2,.4,.4,.4))
plots_chrX <- plot_chromothripsis(ShatterSeek_output = chromothripsis,
chr = "chrX", sample_name="DO17373", genome="hg19")
plot_chrX = arrangeGrob(plots_chrX[[1]],
plots_chrX[[2]],
plots_chrX[[3]],
plots_chrX[[4]],
nrow=4,ncol=1,heights=c(0.2,.4,.4,.4))
plot_grid(plot_chr21, plot_chrX)
View(CN_data)
library(ShatterSeek)
data(DO17373)
View(BAF_DO17373_chr3)
View(BAF_DO17373_chrX)
View(chromothripsis)
View(CN_data)
CN_data@chrom
CN_data
View(SV_DO17373)
View(SCNA_DO17373)
